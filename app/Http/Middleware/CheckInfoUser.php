<?php

namespace App\Http\Middleware;

use Closure;
use Illuminate\Support\Facades\Redirect;
use Auth;
use App\User;

class CheckInfoUser
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return mixed
     */
    public function handle($request, Closure $next)
    {
        if(!Auth::guest())
        {
         $user = User::whereIn('codemelli',[5489603836,
						6489950243,
						6489931419,
						2431680630,
						2432723732,
						2432691581,
						2432641515,
						2299787585,
						5469450325,
						2297776713,
						5469751406,
						5469573176,
						5469975711,
						5139456320,
						2282666429,
						6839815803,
						2298649340,
						2293507742,
						2292848910,
						2292909340,
						2292909340,
						2299639098,
						2301410838,
						2298038521,
						2291486152,
						2431620832,
						2299874607,
						2294684168,
						2299852735,
						2370415029,
						2301756173,
						2430469936,
						2391828284,
						2299859391,
						2299600485,
						2292883449,
						2451672102,
						2450264221,
						2452082181,
						2453061225,
						2451631465,
						'khasani',
						2451201819,
						2295779091,
						2450046585,
						2452105325,
						6839596737,
						2297700581,
						2293466949,
						2297598777,
						2294821556,
						6839938931,
						6839972291,
						6839586545,
						2431293068,
						2433174856,
						2430477122,
						2431855759,
						2298399476,
						2291795074,
						2431860345,
						2432959094,
						2433022800,
						2432596080,
						2433228549,
						2372024728,
						2430094835,
						2559844653,
						2559874988,
						2432299582,
						2420151811,
						2433037093,
						2431829537,
						2431078183,
						2430874581,
						2432305582,
						2420112725,
						2433139120,
						2433139716,
						2433156297,
						2430322986,
						2420094190,
						2430397323,
						2430374137,
						2433103800,
						2430341271,
						2432180811,
						2432811127,
						2431975347,
						2432557239,
						2451970545,
						5469844293,
						2420526503,
						5469773470,
						5469588361,
						2450265104,
						5469590933,
						2431625257,
						2433218276,
						2420458168,
						2450179348,
						2450390464])->where('id',Auth::user()->id)->first();
			if($user != null)
                return Redirect::to('home/lock_broker.html');
			
            if(Auth::user()->status == 0 or Auth::user()->city_id == '')
                return Redirect::to('profile/checkInfo.html');
			
        }
        else
        {
            return Redirect::to('login');
        }
        return $next($request);
    }
}
